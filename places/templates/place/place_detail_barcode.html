{% extends "base.html" %}






{% block breadcrumb %}

<ol class="breadcrumb">
                                        <li>
                                            <i class="fa fa-home"></i>
                                            <a href="{% url 'list_place' %}">Home</a>
                                        </li>

                                        <li>
                                            <i class="fa fa-list"></i>
                                            <a href="{% url 'list_place' %}">List Places</a>
                                        </li>

                                        <li class="active">
                                            <i class="fa fa-table"></i>
                                            <a href="{% url 'detail_place' object.pk %}"> {{ object.name }}</a>
                                        </li>

                                        <li class="active">
                                            <i class="fa fa-tags"></i> Code Scan
                                        </li>
                                    </ol>

{% endblock %}


{% block title %}
    {{ object.name }}
{% endblock %}
{% block head %}{{ object.name }}{% endblock %}
{% block head_subtitle %}Scan code to Check-in{% endblock %}

{% block content %}





        <div class="col-lg-12">




            <div class="panel panel-default">

                            <div class="panel-body" style="text-align: center;">
                                <div class="results">
                                    <p><img src="http://chart.apis.google.com/chart?cht=qr&amp;chs=400x400&amp;chl=%7B%22place_id%22%3A%20%22{{object.id}}%22%7D&amp;chld=H|0" alt="QR Code"></p>

                                </div>

                            </div>





            </div>

        </div>




<script>
function myMap() {
  var myCenter = new google.maps.LatLng({{ place.latitude }},{{ place.longitude }});
  var mapCanvas = document.getElementById("map");
  var mapOptions = {center: myCenter, zoom: 14, scrollwheel: false,};
  var map = new google.maps.Map(mapCanvas, mapOptions);
  var marker = new google.maps.Marker({position:myCenter});
  marker.setMap(map);
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmz7oHEd5LqSGdal0vtfWUOkxn9GSUKt4&callback=myMap"></script>


<script>

    function deletePlace(id) {
        var ask = window.confirm("Are you sure you want to delete this post?");
        if (ask) {
            //window.alert("This post was successfully deleted.");

            window.location.replace('/places/place/delete/'+id);

        }
    }

    function updatePlace(id) {
         window.location.replace('/places/place/update/'+id);
    }


    function deleteOffer(id) {
        var ask = window.confirm("Are you sure you want to delete this offer?");
        if (ask) {
            //window.alert("This post was successfully deleted.");

            window.location.replace('/places/offer/delete/'+id);

        }
    }


    function deletePlaceUser(placeId, userId){
        var ask = window.confirm("Are you sure you want to unsubscribe this user from your place?");
        if (ask) {
            //window.alert("This post was successfully deleted.");

            window.location.replace('/places/placeSubscriber/delete/?place_id='+placeId+'&user_id='+userId);

        }
    }

    function sendPushNotificationToUser(ionic_id){

        var message = prompt("Please enter the push notification message", "Message");


        var jsonObject = {
                      "user_ids": [ionic_id],
                      "profile": "placesappdev",
                      "notification": {
                        "title": "Places App",
                        "message": message,
                        "android": {
                          "title": "{{ object.name }}",
                          "message": message
                        },
                        "ios": {
                          "title": "Places App",
                          "message": message
                        }
                      }
                    }


        if (message != null) {
            $.ajax({
                url: 'https://api.ionic.io/push/notifications',
                type: 'post',
                data: JSON.stringify(jsonObject),
                headers: {
                    "Accept" : "application/json; charset=utf-8",
                    "Content-Type": "application/json; charset=utf-8",
                    "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiYjZkM2U1OC02NTRiLTQxNjUtYWVlYy01MTQ5YmU2Y2FjYWYifQ.qY2CNGV4ffSCgGt2zO262b0OBgp_34rsxxu5EZhWtgM"
                },
                dataType: 'json',
                success: function (data) {
                    console.info(data);
                }
            });

        }
    }



</script>


{% endblock %}